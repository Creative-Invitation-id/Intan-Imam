<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8" />
  <meta name="format-detection" content="telephone=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="The Wedding of Giofazil & Yoana" />
  <meta property="og:description" content="You are cordially invited to our wedding celebration." />
  <meta property="og:image" content="http://giofazil-yoana.vercel.app/assets/images/slide10/animasi.jpeg" />
  <meta property="og:url" content="http://giofazil-yoana.vercel.app" />

  <!-- Optional tapi disarankan -->
  <meta property="og:site_name" content="Wedding Invitation" />
  <title>Giofazil-Yoana Wedding Invitation</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div class="mobile-wrapper">
    <audio id="bgMusic" loop>
      <source src="assets/song.mp3" type="audio/mpeg" />
    </audio>

    <div id="musicControl" class="music-control" onclick="toggleMusic()">
      <div class="music-box" id="musicBox">
        <span id="musicIcon">üîä</span>
      </div>
    </div>
    <div class="pages" id="pagesContainer">
      <section class="page cover">
        <img src="assets/images/slide1/background1.png" class="cover-bg" alt="Background" />
        <img src="assets/images/slide1/frame-top1.png" class="frame-top anim-fade" alt="Frame Top" />

        <img src="assets/images/slide1/frame-left1.png" class="frame-side-left anim-fade" alt="Frame Left" />
        <img src="assets/images/slide1/frame-right1.png" class="frame-side-right anim-fade" alt="Frame Right" />
        <img src="assets/images/slide1/frame-bot1.png" class="frame-bottom-gunungan anim-fade" alt="Gunungan" />

        <div class="cover-content anim-fade delay-1">
          <button class="btn-open" onclick="openInvitation()">Open Invitation</button>
        </div>
      </section>

      <section class="page" id="page2">
        <img src="assets/images/slide2/background2.png" class="cover-bg" alt="Background" />
        <img src="assets/images/slide2/frame-bot2.png" class="page2-frame-top anim-fade" alt="Top Decoration" />
        <img src="assets/images/slide2/frame-left2.png" class="page2-frame-left anim-fade" alt="Left Frame" />
        <img src="assets/images/slide2/frame-right2.png" class="page2-frame-right anim-fade" alt="Right Frame" />

        <div class="page-inner">
          <div id="content2Wrapper" class="content-wrapper" style="opacity: 0">
            <img src="assets/images/slide2/content-mid2.png" class="content-mid" alt="Content" />
          </div>

          <button id="btnNext2" class="btn-next-round" style="opacity: 0" onclick="goToPage(2)">‚Üí</button>
        </div>
      </section>

      <section class="page" id="page3">
        <img src="assets/images/background.png" class="page-bg-static" alt="Background" />
        <div class="page-inner">
          <div class="split-container-3parts">
            <div id="p3Div1" class="section-part-3 p3-part-top" style="opacity: 0">
              <img src="assets/images/slide3/content1-3-3.png" class="content-image" />
            </div>

            <div id="p3Div2" class="section-part-3 p3-part-middle" style="opacity: 0">
              <img src="assets/images/slide3/content2-3-3.png" class="content-image" />
            </div>

            <div id="p3Div3" class="section-part-3 p3-part-bottom" style="opacity: 0">
              <img src="assets/images/slide3/content3-3-3.png" class="content-image" />
              <a href="https://www.instagram.com/nvvii_14" target="_blank" class="btn-instagram btn-instagram-left">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                  <path
                    d="M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.917 3.917 0 0 0-1.417.923A3.927 3.927 0 0 0 .42 2.76C.222 3.268.087 3.85.048 4.7.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.298-.048c.851-.04 1.434-.174 1.943-.372a3.916 3.916 0 0 0 1.416-.923c.445-.445.718-.891.923-1.417.197-.509.332-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.299c-.04-.851-.175-1.433-.372-1.941a3.926 3.926 0 0 0-.923-1.417A3.911 3.911 0 0 0 13.24.42c-.51-.198-1.092-.333-1.943-.372C10.443.01 10.172 0 7.998 0h.003zm-.717 1.442h.718c2.136 0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599.28.28.453.546.598.92.11.281.24.705.275 1.485.039.843.047 1.096.047 3.231s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.47 2.47 0 0 1-.599.919c-.28.28-.546.453-.92.598-.28.11-.704.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.478 2.478 0 0 1-.92-.598 2.48 2.48 0 0 1-.6-.92c-.109-.281-.24-.705-.275-1.485-.038-.843-.046-1.096-.046-3.233 0-2.136.008-2.388.046-3.231.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92.28-.28.546-.453.92-.598.282-.11.705-.24 1.485-.276.738-.034 1.024-.044 2.515-.045v.002zm4.988 1.328a.96.96 0 1 0 0 1.92.96.96 0 0 0 0-1.92zm-4.27 1.122a4.109 4.109 0 1 0 0 8.217 4.109 4.109 0 0 0 0-8.217zm0 1.441a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334z" />
                </svg>
              </a>
            </div>
          </div>

          <div id="btnNav3" class="nav-group" style="opacity: 0">
            <button class="btn-nav-small" onclick="goToPage(1)">‚Üê</button>
            <button class="btn-nav-small" onclick="goToPageHorizontal(3)">‚Üí</button>
          </div>
        </div>
      </section>

      <section class="page" id="page4">
        <img src="assets/images/background.png" class="page-bg-static" alt="Background" />
        <div class="page-inner">
          <div class="split-container-3parts">
            <div id="p4Div1" class="section-part-3 p4-part-top" style="opacity: 0">
              <img src="assets/images/slide4/content1-3-4.png" class="content-image" />
            </div>

            <div id="p4Div2" class="section-part-3 p4-part-middle" style="opacity: 0">
              <img src="assets/images/slide4/content2-3-4.png" class="content-image" />
            </div>

            <div id="p4Div3" class="section-part-3 p4-part-bottom" style="opacity: 0">
              <img src="assets/images/slide4/content3-3-4.png" class="content-image" />
              <a href="https://www.instagram.com/turmudhi_im" target="_blank" class="btn-instagram btn-instagram-right">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                  <path
                    d="M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.917 3.917 0 0 0-1.417.923A3.927 3.927 0 0 0 .42 2.76C.222 3.268.087 3.85.048 4.7.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.298-.048c.851-.04 1.434-.174 1.943-.372a3.916 3.916 0 0 0 1.416-.923c.445-.445.718-.891.923-1.417.197-.509.332-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.299c-.04-.851-.175-1.433-.372-1.941a3.926 3.926 0 0 0-.923-1.417A3.911 3.911 0 0 0 13.24.42c-.51-.198-1.092-.333-1.943-.372C10.443.01 10.172 0 7.998 0h.003zm-.717 1.442h.718c2.136 0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599.28.28.453.546.598.92.11.281.24.705.275 1.485.039.843.047 1.096.047 3.231s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.47 2.47 0 0 1-.599.919c-.28.28-.546.453-.92.598-.28.11-.704.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.478 2.478 0 0 1-.92-.598 2.48 2.48 0 0 1-.6-.92c-.109-.281-.24-.705-.275-1.485-.038-.843-.046-1.096-.046-3.233 0-2.136.008-2.388.046-3.231.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92.28-.28.546-.453.92-.598.282-.11.705-.24 1.485-.276.738-.034 1.024-.044 2.515-.045v.002zm4.988 1.328a.96.96 0 1 0 0 1.92.96.96 0 0 0 0-1.92zm-4.27 1.122a4.109 4.109 0 1 0 0 8.217 4.109 4.109 0 0 0 0-8.217zm0 1.441a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334z" />
                </svg>
              </a>
            </div>
          </div>

          <div class="nav-group" id="btnNav4" style="opacity: 0">
            <button class="btn-nav-small" onclick="goToPageHorizontal(2)">‚Üê</button>
            <button class="btn-nav-small" onclick="goToPage(4)">‚Üí</button>
          </div>
        </div>
      </section>

      <section class="page" id="page5">
        <img src="assets/images/background.png" class="page-bg-static" alt="Background" />
        <div class="page-inner">
          <div class="split-container-2parts">
            <div id="p5Div1" class="section-part-2 p5-part-top" style="opacity: 0">
              <img src="assets/images/slide5/content-top5.png" class="content-image" />
              <a href="https://maps.app.goo.gl/ydDQPv7FVNwCKyVc7?g_st=ic" class="btn-location">LOKASI</a>
            </div>

            <div id="p5Div2" class="section-part-2 p5-part-bottom" style="opacity: 0">
              <img src="assets/images/slide5/content-bot5.png" class="content-image" />
              <a href="https://maps.app.goo.gl/ydDQPv7FVNwCKyVc7?g_st=ic" class="btn-location">LOKASI</a>
            </div>
          </div>

          <div class="nav-group" id="btnNav5" style="opacity: 0">
            <button class="btn-nav-small" onclick="goToPage(3)">‚Üê</button>
            <button class="btn-nav-small" onclick="goToPage(5)">‚Üí</button>
          </div>
        </div>
      </section>

      <section class="page" id="page6">
        <img src="assets/images/background.png" class="page-bg-static" alt="Background" />
        <div class="page-inner">
          <div class="split-container-2parts">
            <div id="p6Div1" class="section-part-2 p6-part-top" style="opacity: 0">
              <img src="assets/images/slide6/content-top6.png" class="content-image" />
              <!-- Countdown Container inside p6Div1 -->
              <div id="countdown" class="countdown-container">
                <div class="countdown-item">
                  <span id="days" class="countdown-number">00</span>
                  <span class="countdown-label">Hari</span>
                </div>
                <div class="countdown-item">
                  <span id="hours" class="countdown-number">00</span>
                  <span class="countdown-label">Jam</span>
                </div>
                <div class="countdown-item">
                  <span id="minutes" class="countdown-number">00</span>
                  <span class="countdown-label">Menit</span>
                </div>
                <div class="countdown-item">
                  <span id="seconds" class="countdown-number">00</span>
                  <span class="countdown-label">Detik</span>
                </div>
              </div>
            </div>

            <div id="p6Div2" class="section-part-2 p6-part-bottom" style="opacity: 0">
              <img src="assets/images/slide6/content-bot6.png" class="content-image" />
            </div>
          </div>

          <div class="nav-group" id="btnNav6" style="opacity: 0">
            <button class="btn-nav-small" onclick="goToPage(4)">‚Üê</button>
            <button class="btn-nav-small" onclick="goToPage(6)">‚Üí</button>
          </div>
        </div>
      </section>

      <section class="page" id="page7">
        <img src="assets/images/background.png" class="page-bg-static" alt="Background" />
        <div class="page-inner">
          <img src="assets/images/slide7/frame-left7.png" id="frameLeft7" class="frame-corner-left" alt="Frame Left" />
          <img src="assets/images/slide7/frame-right7.png" id="frameRight7" class="frame-corner-right"
            alt="Frame Right" />

          <div id="p7Content" class="full-content" style="opacity: 0">
            <img src="assets/images/slide7/content7.png" class="full-content-img" />
          </div>

          <div class="nav-group" id="btnNav7" style="opacity: 0">
            <button class="btn-nav-small" onclick="goToPage(5)">‚Üê</button>
            <button class="btn-nav-small" onclick="goToPage(7)">‚Üí</button>
          </div>
        </div>
      </section>

      <section class="page" id="page8">
        <img src="assets/images/background.png" class="page-bg-static" alt="Background" />
        <div class="page-inner">
          <div class="split-container-3parts">
            <div id="p8Div1" class="section-part-3 p8-part-top" style="opacity: 0">
              <img src="assets/images/slide8/top-8.png" class="content-image" />
            </div>

            <div id="p8Div2" class="section-part-3 p8-part-middle" style="opacity: 0">
              <img src="assets/images/slide8/mid-8.png" class="content-image" />
            </div>

            <div id="p8Div3" class="section-part-3 p8-part-bottom" style="opacity: 0">
              <button class="btn-gallery" onclick="window.location.href='gallery.html'">Buka Galeri</button>
            </div>
          </div>

          <div class="nav-group" id="btnNav8" style="opacity: 0">
            <button class="btn-nav-small" onclick="goToPage(6)">‚Üê</button>
            <button class="btn-nav-small" onclick="goToPage(8)">‚Üí</button>
          </div>
        </div>
      </section>


      <section class="page" id="page9">
        <img src="assets/images/background.png" class="page-bg-static" alt="Background" />
        <div class="page-inner">
          <div class="split-container-2parts">
            <div id="p9Div1" class="section-part-2 p9-part-top" style="opacity: 0">
              <img src="assets/images/slide9/top9.png" class="content-image" />
              <div class="gift-container">
                <div class="bank-card">
                  <p class="bank-name">Intan Nur Avivah / BCA</p>
                  <div class="account-box">
                    <span class="account-number">0502266380</span>
                    <button class="btn-copy" onclick="copyToClipboard('0502266380')">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                        viewBox="0 0 16 16">
                        <path
                          d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z" />
                        <path
                          d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z" />
                      </svg>
                    </button>
                  </div>
                </div>

                <div class="bank-card">
                  <p class="bank-name">Imam Turmudhi / BCA</p>
                  <div class="account-box">
                    <span class="account-number">0500850451</span>
                    <button class="btn-copy" onclick="copyToClipboard('0500850451')">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                        viewBox="0 0 16 16">
                        <path
                          d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z" />
                        <path
                          d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z" />
                      </svg>
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <div id="p9Div2" class="section-part-2 p9-part-bottom" style="opacity: 0">
              <img src="assets/images/slide9/bot9.png" class="content-image" style="margin-bottom: 20px;" />
              <div class="btn-group-rsvp">
                <a href="https://wa.me/6285733602339?text=Halo,%20saya%20ingin%20konfirmasi%20bahwa%20saya%20akan%20Hadir%20di%20pernikahan%20Intan%20%26%20Imam"
                  target="_blank" class="btn-rsvp">
                  Konfirmasi Hadir
                </a>
                <a href="https://wa.me/6285733602339?text=Halo,%20mohon%20maaf%20saya%20Berhalangan%20Hadir%20di%20pernikahan%20Intan%20%26%20Imam"
                  target="_blank" class="btn-rsvp">
                  Maaf, Berhalangan Hadir
                </a>
              </div>
            </div>
          </div>

          <div class="nav-group" id="btnNav9" style="opacity: 0">
            <button class="btn-nav-small" onclick="goToPage(7)">‚Üê</button>
            <button class="btn-nav-small" onclick="goToPage(9)">‚Üí</button>
          </div>
        </div>
      </section>

      <section class="page" id="page10">
        <img src="assets/images/background.png" class="page-bg-static" alt="Background" />
        <img src="assets/images/slide10/frame-left10.png" class="page10-frame-left" alt="Left Frame" />
        <img src="assets/images/slide10/frame-right10.png" class="page10-frame-right" alt="Right Frame" />
        <div class="page-inner">
          <div class="split-container-2parts">
            <div id="p10Div1" class="section-part-2 p10-part-top" style="opacity: 0">
              <img src="assets/images/slide10/top10.png" class="content-image" />
            </div>

            <div id="p10Div2" class="section-part-2 p10-part-bottom" style="opacity: 0">
              <img src="assets/images/slide10/bot10.png" class="content-image" />
            </div>
          </div>

          <div class="nav-group" id="btnNav10" style="opacity: 0">
            <button class="btn-nav-small" onclick="goToPage(8)">‚Üê</button>
          </div>
        </div>
      </section>

      <script>
        function copyToClipboard(text) {
          navigator.clipboard.writeText(text).then(() => {
            alert("Nomor rekening berhasil disalin: " + text);
          });
        }

        const STORAGE_KEY_TIME = "wedding_invitation_music_time";
        let isMusicPlaying = false; // Track intended state

        // Initialize music state on load
        document.addEventListener('DOMContentLoaded', () => {
          const bgMusic = document.getElementById("bgMusic");
          const savedTime = localStorage.getItem(STORAGE_KEY_TIME);
          if (savedTime) {
            bgMusic.currentTime = parseFloat(savedTime);
          }
        });

        // 1. Fungsi khusus yang dipicu oleh tombol "Open Invitation"
        function openInvitation() {
          // Enable Scroll
          document.querySelector('.mobile-wrapper').style.overflowY = 'auto';

          // Jalankan navigasi ke halaman kedua (Mempelai)
          document.getElementById('page2').scrollIntoView({ behavior: 'smooth' });

          // Jalankan musik (Ini aman karena dipicu langsung oleh klik tombol)
          const bgMusic = document.getElementById("bgMusic");
          const musicControl = document.getElementById("musicControl");

          // Always start from the beginning
          bgMusic.currentTime = 0;

          bgMusic
            .play()
            .then(() => {
              isMusicPlaying = true;
              musicControl.style.display = "flex"; // Munculkan tombol music
              document.getElementById("musicBox").classList.add("rotating");
            })
            .catch((error) => {
              console.log("Autoplay failed/blocked", error);
              // Jika tetap diblokir, tombol muncul agar user bisa klik manual
              musicControl.style.display = "flex";
            });
        }

        function toggleMusic() {
          const bgMusic = document.getElementById("bgMusic");
          const musicControl = document.getElementById("musicIcon");
          const musicBox = document.getElementById("musicBox");

          if (bgMusic.paused) {
            bgMusic.play();
            isMusicPlaying = true;
            musicControl.innerText = "üîä";
            musicBox.classList.add("rotating");
          } else {
            bgMusic.pause();
            isMusicPlaying = false;
            musicControl.innerText = "üîá";
            musicBox.classList.remove("rotating");
          }
        }

        // Save time continuously
        document.getElementById("bgMusic").addEventListener("timeupdate", () => {
          const bgMusic = document.getElementById("bgMusic");
          localStorage.setItem(STORAGE_KEY_TIME, bgMusic.currentTime);
        });

        // Handle Tab Visibility (Pause on hide, Resume on show)
        document.addEventListener("visibilitychange", () => {
          const bgMusic = document.getElementById("bgMusic");
          const musicBox = document.getElementById("musicBox");

          if (document.hidden) {
            // If tab is hidden, pause music but keep 'isMusicPlaying' true if it WAS playing
            // so we know to resume it later.
            if (!bgMusic.paused) {
              bgMusic.pause();
              isMusicPlaying = true; // Mark that it SHOULD be playing
              musicBox.classList.remove("rotating"); // Visual pause
            }
          } else {
            // If tab is visible again, and it was supposed to be playing, resume
            if (isMusicPlaying) {
              bgMusic.play().catch(e => console.log("Resume blocked", e));
              musicBox.classList.add("rotating");
            }
          }
        });

        // --- SCROLL ANIMATION LOGIC ---
        
        const animationHandlers = {
          page1: () => {
             // Cover animations (if needed) - typically handled by CSS on load, but we can enforce here
             const coverContent = document.querySelector('.cover-content'); 
             if(coverContent && !coverContent.classList.contains('anim-fade')) {
                coverContent.classList.add('anim-fade');
             }
          },
          page2: () => {
            const content = document.getElementById("content2Wrapper");
            // Select all new decorative elements in Page 2
            const elementsToAnimate = document.querySelectorAll("#page2 .page2-bg, #page2 .page2-frame-top, #page2 .page2-frame-left, #page2 .page2-frame-right");

            if(content.classList.contains("anim-fade")) return; // Already animated

            setTimeout(() => {
              elementsToAnimate.forEach(el => el.classList.add("anim-fade"));
              content.classList.add("anim-fade");
            }, 300);
          },
          page3: () => {
             const div1 = document.getElementById("p3Div1");
             const div2 = document.getElementById("p3Div2");
             const div3 = document.getElementById("p3Div3");
             
             if(div1.classList.contains("anim-slide-left")) return;

             setTimeout(() => {
               div1.classList.add("anim-slide-left");
               setTimeout(() => {
                 div2.classList.add("anim-slide-left");
                 setTimeout(() => {
                   div3.classList.add("anim-slide-left");
                 }, 400);
               }, 400);
             }, 300);
          },
          page4: () => {
            const div1 = document.getElementById("p4Div1");
            const div2 = document.getElementById("p4Div2");
            const div3 = document.getElementById("p4Div3");

            if(div1.classList.contains("anim-slide-right")) return;

            setTimeout(() => {
               div1.classList.add("anim-slide-right");
               setTimeout(() => {
                 div2.classList.add("anim-slide-right");
                 setTimeout(() => {
                   div3.classList.add("anim-slide-right");
                 }, 400);
               }, 400);
             }, 300);
          },
          page5: () => {
             const div1 = document.getElementById("p5Div1");
             const div2 = document.getElementById("p5Div2");

             if(div1.classList.contains("anim-fade")) return;

             setTimeout(() => {
               div1.classList.add("anim-fade");
               setTimeout(() => {
                 div2.classList.add("anim-fade");
               }, 400);
             }, 300);
          },
          page6: () => {
             const div1 = document.getElementById("p6Div1");
             const div2 = document.getElementById("p6Div2");
             
             if(div1.classList.contains("anim-fade")) return;
             
             setTimeout(() => {
               div1.classList.add("anim-fade");
               setTimeout(() => {
                 div2.classList.add("anim-fade");
               }, 400);
             }, 300);
          },
          page7: () => {
             const content = document.getElementById("p7Content");
             if(content.classList.contains("anim-zoom")) return;
             setTimeout(() => content.classList.add("anim-zoom"), 300);
          },
          page8: () => {
             const div1 = document.getElementById("p8Div1");
             const div2 = document.getElementById("p8Div2");
             const div3 = document.getElementById("p8Div3");
             
             if(div1.classList.contains("anim-slide-up")) return;

             setTimeout(() => {
               div1.classList.add("anim-slide-up");
               setTimeout(() => {
                 div2.classList.add("anim-slide-up");
                 setTimeout(() => {
                   div3.classList.add("anim-slide-up");
                 }, 400);
               }, 400);
             }, 300);
          },
          page9: () => {
             const div1 = document.getElementById("p9Div1");
             const div2 = document.getElementById("p9Div2");

             if(div1.classList.contains("anim-fade")) return;

             setTimeout(() => {
               div1.classList.add("anim-fade");
               setTimeout(() => {
                 div2.classList.add("anim-fade");
               }, 400);
             }, 300);
          },
          page10: () => {
             const div1 = document.getElementById("p10Div1");
             const div2 = document.getElementById("p10Div2");
             
             if(div1.classList.contains("anim-fade")) return;
             
             setTimeout(() => {
                 div1.classList.add("anim-fade");
                 setTimeout(() => {
                     if(div2) div2.classList.add("anim-fade");
                 }, 400);
             }, 300);
          }
        };

        const observerOptions = {
          root: null,
          threshold: 0.2 // Trigger when 20% visible
        };

        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              const pageId = entry.target.id;
              if (animationHandlers[pageId]) {
                animationHandlers[pageId]();
              }
            }
          });
        }, observerOptions);

        document.addEventListener('DOMContentLoaded', () => {
           // Start observing all pages
           document.querySelectorAll('.page').forEach(page => {
             observer.observe(page);
           });

           // Check for hash to support deep linking (returning from gallery)
           if (window.location.hash) {
             const targetId = window.location.hash.substring(1); // remove '#'
             const targetElement = document.getElementById(targetId);
             
             if(targetElement) {
                // Unlock scroll immediately
                document.querySelector('.mobile-wrapper').style.overflowY = 'auto';
                
                // Scroll to target
                setTimeout(() => {
                  targetElement.scrollIntoView({ behavior: 'smooth' });
                }, 100);

                // FORCE RESUME MUSIC
                const musicControl = document.getElementById("musicControl");
                const bgMusic = document.getElementById("bgMusic");
                const savedTime = localStorage.getItem(STORAGE_KEY_TIME);
                
                // Show control
                musicControl.style.display = 'flex';
                
                if(savedTime) { 
                   bgMusic.currentTime = parseFloat(savedTime);
                }

                bgMusic.play().then(() => {
                   isMusicPlaying = true;
                   document.getElementById("musicBox").classList.add("rotating");
                   document.getElementById("musicIcon").innerText = "üîä";
                }).catch(e => {
                   console.log("Auto-resume blocked by browser policy", e);
                   // Still show button so they can click it
                   document.getElementById("musicIcon").innerText = "üîá";
                });
             }
           }
        });

        // --- Save The Date Countdown Logic ---
        function startCountdown() {
          const targetDate = new Date("March 3, 2026 00:00:00").getTime();

          if (isNaN(targetDate)) return; // Safety check

          const timer = setInterval(() => {
            const now = new Date().getTime();
            const distance = targetDate - now;

            if (distance < 0) {
              clearInterval(timer);
              document.getElementById("countdown").innerHTML = "The Wedding Has Passed";
              return;
            }

            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            // Update UI with leading zero
            document.getElementById("days").innerText = days < 10 ? "0" + days : days;
            document.getElementById("hours").innerText = hours < 10 ? "0" + hours : hours;
            document.getElementById("minutes").innerText = minutes < 10 ? "0" + minutes : minutes;
            document.getElementById("seconds").innerText = seconds < 10 ? "0" + seconds : seconds;

          }, 1000);
        }

        // Start countdown immediately
        startCountdown();
      </script>
</body>

</html>